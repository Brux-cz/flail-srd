<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLAIL - Den√≠k Barda</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Special+Elite&family=Oswald:wght@400;700&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --black: #111;
            --white: #fff;
            --gray: #666;
            --light-gray: #e5e5e5;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--light-gray);
            padding: 20px;
            font-size: 12px;
        }

        .toolbar {
            max-width: 800px;
            margin: 0 auto 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .toolbar button {
            background: var(--black);
            color: var(--white);
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 12px;
            font-family: inherit;
        }

        .toolbar button:hover {
            background: #333;
        }

        .toolbar button.danger {
            background: #666;
        }

        .file-input { display: none; }

        .sheet {
            max-width: 800px;
            margin: 0 auto;
            background: var(--white);
            border: 3px solid var(--black);
            padding: 15px;
            box-shadow: 5px 5px 0 var(--black);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            border-bottom: 2px solid var(--black);
            padding-bottom: 10px;
        }

        .name-block {
            flex: 1;
        }

        .name-label {
            font-size: 9px;
            color: var(--gray);
            font-style: italic;
        }

        .name-input {
            width: 100%;
            border: none;
            border-bottom: 2px solid var(--black);
            font-size: 14px;
            font-style: italic;
            padding: 5px 0;
            background: transparent;
            font-family: 'Special Elite', monospace;
        }

        .name-input:focus {
            outline: none;
            background: #fffef0;
        }

        .logo {
            font-family: 'Oswald', sans-serif;
            font-size: 36px;
            font-weight: 700;
            letter-spacing: 2px;
            margin-left: 15px;
        }

        .logo-bug {
            font-size: 24px;
        }

        /* Special Skills Box */
        .skills-box {
            border: 3px solid var(--black);
            padding: 10px;
            margin-bottom: 12px;
            background: var(--white);
        }

        .skills-title {
            font-family: 'Oswald', sans-serif;
            font-size: 16px;
            font-weight: 700;
            border-bottom: 3px solid var(--black);
            padding-bottom: 3px;
            margin-bottom: 8px;
        }

        .skill-line {
            margin-bottom: 4px;
            font-size: 11px;
            line-height: 1.4;
        }

        .skill-name {
            font-weight: bold;
        }

        /* Stats Row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .stat-box {
            border: 3px solid var(--black);
            text-align: center;
        }

        .stat-header {
            background: var(--black);
            color: var(--white);
            font-family: 'Oswald', sans-serif;
            font-size: 18px;
            font-weight: 700;
            padding: 3px;
        }

        .stat-body {
            padding: 8px 5px;
            display: flex;
            justify-content: center;
            align-items: baseline;
            gap: 3px;
        }

        .stat-input {
            width: 35px;
            font-size: 22px;
            font-weight: bold;
            text-align: center;
            border: none;
            border-bottom: 2px solid var(--black);
            background: transparent;
            font-family: inherit;
        }

        .stat-input:focus {
            outline: none;
            background: #fffef0;
        }

        .stat-sep {
            font-size: 22px;
            color: var(--gray);
        }

        .stat-labels {
            display: flex;
            justify-content: space-around;
            font-size: 8px;
            color: var(--gray);
            padding: 0 5px 5px;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 200px 1fr 1fr;
            gap: 10px;
        }

        @media (max-width: 700px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Left Column */
        .left-col {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* Level Box */
        .level-box {
            border: 3px solid var(--black);
            padding: 8px;
        }

        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .level-title {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 14px;
            border-bottom: 2px solid var(--black);
        }

        .level-subtitle {
            font-size: 8px;
            color: var(--gray);
        }

        .level-grid {
            display: grid;
            grid-template-columns: auto 1fr 1fr;
            gap: 2px;
            margin-top: 5px;
            font-size: 11px;
        }

        .level-num {
            font-weight: bold;
            padding-right: 5px;
        }

        .level-check {
            width: 16px;
            height: 16px;
            border: 2px solid var(--black);
            border-radius: 50%;
            appearance: none;
            cursor: pointer;
            margin: 0;
        }

        .level-check:checked {
            background: var(--black);
        }

        /* HP/Coins */
        .hp-coins {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }

        .resource-box {
            flex: 1;
            text-align: center;
        }

        .resource-icon {
            font-size: 20px;
        }

        .resource-label {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 12px;
        }

        .resource-input {
            width: 50px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            border: 2px solid var(--black);
            background: transparent;
        }

        .resource-input:focus {
            outline: none;
            background: #fffef0;
        }

        .resource-sub {
            font-size: 8px;
            color: var(--gray);
        }

        /* Reputation */
        .reputation-box {
            border: 3px solid var(--black);
            padding: 8px;
        }

        .rep-title {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 12px;
            text-align: center;
            margin-bottom: 5px;
        }

        .rep-track {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            flex-wrap: wrap;
        }

        .rep-arrow {
            font-size: 14px;
        }

        .rep-circle {
            width: 18px;
            height: 18px;
            border: 2px solid var(--black);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            cursor: pointer;
            background: var(--white);
        }

        .rep-circle:hover {
            background: var(--light-gray);
        }

        .rep-circle.active {
            background: var(--black);
            color: var(--white);
        }

        .rep-circle.center {
            background: var(--light-gray);
        }

        .rep-circle.center.active {
            background: var(--black);
            color: var(--white);
        }

        /* Ring Slots */
        .ring-slot {
            border: 2px solid var(--black);
            padding: 6px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .ring-icon {
            font-size: 20px;
            min-width: 25px;
        }

        .ring-label {
            font-size: 8px;
            color: var(--gray);
            font-style: italic;
        }

        .ring-input {
            flex: 1;
            border: none;
            border-bottom: 1px solid var(--gray);
            font-size: 10px;
            padding: 2px;
            background: transparent;
        }

        .ring-input:focus {
            outline: none;
            background: #fffef0;
        }

        /* Equipment Slots */
        .equip-slot {
            border: 3px solid var(--black);
            padding: 8px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .equip-slot.worn {
            background: var(--light-gray);
        }

        .equip-label {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 11px;
            min-width: 60px;
        }

        .equip-input {
            flex: 1;
            border: none;
            border-bottom: 2px solid var(--black);
            font-size: 11px;
            padding: 3px;
            background: transparent;
            font-family: 'Special Elite', monospace;
        }

        .equip-input:focus {
            outline: none;
            background: #fffef0;
        }

        .equip-num {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 14px;
        }

        /* Middle Column - Body Slots */
        .body-col {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .body-slot {
            border: 3px solid var(--black);
            min-height: 65px;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .body-header {
            background: var(--black);
            color: var(--white);
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 11px;
            padding: 2px 5px;
            display: flex;
            justify-content: space-between;
        }

        .body-num {
            font-size: 20px;
        }

        .body-input {
            flex: 1;
            border: none;
            padding: 5px;
            font-size: 11px;
            resize: none;
            font-family: 'Special Elite', monospace;
            background: transparent;
        }

        .body-input:focus {
            outline: none;
            background: #fffef0;
        }

        /* Right Column - Stashed */
        .stash-col {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stash-slot {
            border: 3px dashed var(--black);
            min-height: 65px;
            position: relative;
            display: flex;
            flex-direction: column;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(0,0,0,0.02) 10px,
                rgba(0,0,0,0.02) 20px
            );
        }

        .stash-slot.locked {
            opacity: 0.5;
        }

        .stash-input {
            flex: 1;
            border: none;
            padding: 5px;
            font-size: 11px;
            resize: none;
            font-family: 'Special Elite', monospace;
            background: transparent;
        }

        .stash-input:focus {
            outline: none;
            background: #fffef0;
        }

        .unlock-label {
            font-size: 8px;
            color: var(--gray);
            text-align: center;
            padding: 3px;
            border-top: 1px dashed var(--gray);
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: space-around;
            font-size: 9px;
            color: var(--gray);
            margin: 10px 0;
            padding: 5px 0;
            border-top: 1px solid var(--light-gray);
            border-bottom: 1px solid var(--light-gray);
        }

        /* Instruments Section */
        .instruments-section {
            border: 3px solid var(--black);
            padding: 10px;
            margin-top: 10px;
        }

        .inst-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 3px solid var(--black);
            padding-bottom: 3px;
            margin-bottom: 8px;
        }

        .inst-title {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 14px;
        }

        .inst-note {
            font-size: 9px;
            font-style: italic;
            color: var(--gray);
        }

        .inst-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        @media (max-width: 600px) {
            .inst-grid {
                grid-template-columns: 1fr;
            }
        }

        .inst-slot {
            border: 3px solid var(--black);
            min-height: 70px;
            display: flex;
            flex-direction: column;
        }

        .inst-slot.locked {
            border-style: dashed;
            opacity: 0.6;
        }

        .inst-slot-header {
            background: var(--black);
            color: var(--white);
            font-family: 'Oswald', sans-serif;
            font-size: 10px;
            padding: 2px 5px;
            text-align: center;
        }

        .inst-input {
            flex: 1;
            border: none;
            padding: 5px;
            font-size: 11px;
            resize: none;
            font-family: 'Special Elite', monospace;
            background: transparent;
        }

        .inst-input:focus {
            outline: none;
            background: #fffef0;
        }

        /* Jack of All Trades */
        .jack-section {
            border: 3px solid var(--black);
            padding: 10px;
            margin-top: 10px;
        }

        .jack-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 3px solid var(--black);
            padding-bottom: 3px;
            margin-bottom: 8px;
        }

        .jack-title {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            font-size: 14px;
        }

        .jack-used {
            font-size: 9px;
            color: var(--gray);
        }

        .jack-entries {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .jack-entry {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px;
            background: var(--light-gray);
            border: 1px solid var(--black);
        }

        .jack-input {
            flex: 1;
            border: none;
            border-bottom: 1px solid var(--black);
            font-size: 11px;
            padding: 3px;
            background: transparent;
            font-family: 'Special Elite', monospace;
        }

        .jack-input:focus {
            outline: none;
            background: #fffef0;
        }

        .jack-check {
            width: 18px;
            height: 18px;
            border: 2px solid var(--black);
            appearance: none;
            cursor: pointer;
            background: var(--white);
        }

        .jack-check:checked {
            background: var(--black);
        }

        .jack-check:checked::after {
            content: '‚úì';
            color: var(--white);
            display: flex;
            justify-content: center;
            font-size: 12px;
        }

        .remove-btn {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: var(--gray);
            padding: 0 3px;
        }

        .remove-btn:hover {
            color: var(--black);
        }

        .add-btn {
            width: 100%;
            padding: 8px;
            border: 2px dashed var(--black);
            background: transparent;
            cursor: pointer;
            font-size: 11px;
            margin-top: 5px;
        }

        .add-btn:hover {
            background: var(--light-gray);
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .toolbar {
                display: none !important;
            }

            .sheet {
                box-shadow: none;
                border-width: 2px;
                max-width: 100%;
            }

            .add-btn, .remove-btn {
                display: none !important;
            }
        }

        /* Saved Notice */
        .saved-notice {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--black);
            color: var(--white);
            padding: 12px 20px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .saved-notice.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="toolbar">
        <button onclick="saveToFile()">üíæ Ulo≈æit</button>
        <button onclick="document.getElementById('loadFile').click()">üìÇ Naƒç√≠st</button>
        <input type="file" id="loadFile" class="file-input" accept=".json" onchange="loadFromFile(event)">
        <button onclick="window.print()">üñ®Ô∏è Tisk</button>
        <button class="danger" onclick="if(confirm('Reset?')) location.reload()">üóëÔ∏è Reset</button>
    </div>

    <div class="sheet">
        <!-- Header -->
        <div class="header">
            <div class="name-block">
                <div class="name-label">jm√©no a p≈ô√≠bƒõh</div>
                <input type="text" class="name-input" id="charName" placeholder="Jm√©no, rasa, povol√°n√≠ ‚Äì speci√°ln√≠ bonus z p≈ô√≠bƒõhu...">
            </div>
            <div class="logo">
                <span class="logo-bug">ü™≤</span> FLAIL
            </div>
        </div>

        <!-- Special Skills -->
        <div class="skills-box">
            <div class="skills-title">Speci√°ln√≠ dovednosti</div>
            <div class="skill-line"><span class="skill-name">V≈°eumƒõl:</span> na ka≈æd√© √∫rovni si vezmi talent Hrdlo≈ôeza, vyn√°lez Kut√≠lka nebo kouzlo ƒåarodƒõje.</div>
            <div class="skill-line"><span class="skill-name">St≈ô√≠brn√Ω jazyk:</span> v√Ωhoda na CHA hody zahrnuj√≠c√≠ soci√°ln√≠ dovednosti, jako flirtov√°n√≠, p≈ôesvƒõdƒçov√°n√≠ nebo manipulaci.</div>
            <div class="skill-line"><span class="skill-name">V≈°ichni se d√≠vejte!:</span> p≈ôi hozen√≠ triplet≈Ø na Z√°sah zp≈Øsob extra k6 po≈°kozen√≠ a dej spojenc≈Øm +1 HZ (p≈ô√≠≈°t√≠ kolo).</div>
            <div class="skill-line"><span class="skill-name">Hudebn√≠ talenty:</span> hoƒè CHA z√°chrann√Ω hod pro hran√≠ na nesen√Ω n√°stroj, pak hoƒè na tabulku n√°stroje.</div>
        </div>

        <!-- Stats Row -->
        <div class="stats-row">
            <div class="stat-box">
                <div class="stat-header">S√çL</div>
                <div class="stat-body">
                    <input type="number" class="stat-input" id="strBase" value="7" min="1" max="20">
                    <span class="stat-sep">/</span>
                    <input type="number" class="stat-input" id="strCurr" placeholder="‚Äî" min="0" max="20">
                </div>
                <div class="stat-labels"><span>Z√°klad</span><span>Aktu√°ln√≠</span></div>
            </div>
            <div class="stat-box">
                <div class="stat-header">OBR</div>
                <div class="stat-body">
                    <input type="number" class="stat-input" id="dexBase" value="10" min="1" max="20">
                    <span class="stat-sep">/</span>
                    <input type="number" class="stat-input" id="dexCurr" placeholder="‚Äî" min="0" max="20">
                </div>
                <div class="stat-labels"><span>Z√°klad</span><span>Aktu√°ln√≠</span></div>
            </div>
            <div class="stat-box">
                <div class="stat-header">CHA</div>
                <div class="stat-body">
                    <input type="number" class="stat-input" id="chaBase" value="11" min="1" max="20">
                    <span class="stat-sep">/</span>
                    <input type="number" class="stat-input" id="chaCurr" placeholder="‚Äî" min="0" max="20">
                </div>
                <div class="stat-labels"><span>Z√°klad</span><span>Aktu√°ln√≠</span></div>
            </div>
            <div class="stat-box">
                <div class="stat-header">INT</div>
                <div class="stat-body">
                    <input type="number" class="stat-input" id="intBase" value="8" min="1" max="20">
                    <span class="stat-sep">/</span>
                    <input type="number" class="stat-input" id="intCurr" placeholder="‚Äî" min="0" max="20">
                </div>
                <div class="stat-labels"><span>Z√°klad</span><span>Aktu√°ln√≠</span></div>
            </div>
            <div class="stat-box">
                <div class="stat-header">≈†Tƒö</div>
                <div class="stat-body">
                    <input type="number" class="stat-input" id="luckBase" value="10" min="1" max="20">
                    <span class="stat-sep">/</span>
                    <input type="number" class="stat-input" id="luckCurr" placeholder="‚Äî" min="0" max="20">
                </div>
                <div class="stat-labels"><span>Z√°klad</span><span>Aktu√°ln√≠</span></div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Left Column -->
            <div class="left-col">
                <!-- Level Box -->
                <div class="level-box">
                    <div class="level-header">
                        <div>
                            <div class="level-title">√örove≈à</div>
                            <div class="level-subtitle">Oznaƒç v≈°e v ≈ôadƒõ pro postup</div>
                        </div>
                    </div>
                    <div class="level-grid">
                        <span class="level-num">‚ë†</span>
                        <input type="checkbox" class="level-check" data-level="1" data-pos="1">
                        <input type="checkbox" class="level-check" data-level="1" data-pos="2">
                        <span class="level-num">‚ë°</span>
                        <input type="checkbox" class="level-check" data-level="2" data-pos="1">
                        <input type="checkbox" class="level-check" data-level="2" data-pos="2">
                        <span class="level-num">‚ë¢</span>
                        <input type="checkbox" class="level-check" data-level="3" data-pos="1">
                        <input type="checkbox" class="level-check" data-level="3" data-pos="2">
                        <span class="level-num">‚ë£</span>
                        <input type="checkbox" class="level-check" data-level="4" data-pos="1">
                        <input type="checkbox" class="level-check" data-level="4" data-pos="2">
                        <span class="level-num">‚ë§</span>
                        <input type="checkbox" class="level-check" data-level="5" data-pos="1">
                        <input type="checkbox" class="level-check" data-level="5" data-pos="2">
                    </div>

                    <div class="hp-coins">
                        <div class="resource-box">
                            <div class="resource-icon">‚ô•</div>
                            <div class="resource-label">≈ΩIV</div>
                            <input type="number" class="resource-input" id="hp" value="9" min="0">
                            <div class="resource-sub">Z√°klad / Aktu√°ln√≠</div>
                        </div>
                        <div class="resource-box">
                            <div class="resource-icon">üí∞</div>
                            <div class="resource-label">Mince</div>
                            <input type="number" class="resource-input" id="coins" value="20" min="0" max="250">
                            <div class="resource-sub">Max 250</div>
                        </div>
                    </div>
                </div>

                <!-- Reputation -->
                <div class="reputation-box">
                    <div class="rep-title">‚óÑ‚îÄ‚îÄ‚îÄ Reputace ‚îÄ‚îÄ‚îÄ‚ñ∫</div>
                    <div class="rep-track">
                        <div class="rep-circle" data-rep="-6">-6</div>
                        <div class="rep-circle" data-rep="-5">-5</div>
                        <div class="rep-circle" data-rep="-4">-4</div>
                        <div class="rep-circle" data-rep="-3">-3</div>
                        <div class="rep-circle" data-rep="-2">-2</div>
                        <div class="rep-circle" data-rep="-1">-1</div>
                        <div class="rep-circle center active" data-rep="0">‚ò†</div>
                        <div class="rep-circle" data-rep="1">+1</div>
                        <div class="rep-circle" data-rep="2">+2</div>
                        <div class="rep-circle" data-rep="3">+3</div>
                        <div class="rep-circle" data-rep="4">+4</div>
                        <div class="rep-circle" data-rep="5">+5</div>
                        <div class="rep-circle" data-rep="6">+6</div>
                    </div>
                </div>

                <!-- Ring Slots -->
                <div class="ring-slot">
                    <span class="ring-icon">üíç</span>
                    <div style="flex:1">
                        <div class="ring-label">prsten, amulet, peƒçe≈•, talisman</div>
                        <input type="text" class="ring-input" id="ring1">
                    </div>
                </div>
                <div class="ring-slot">
                    <span class="ring-icon">üíç</span>
                    <div style="flex:1">
                        <div class="ring-label">prsten, amulet, peƒçe≈•, talisman</div>
                        <input type="text" class="ring-input" id="ring2">
                    </div>
                </div>

                <!-- Equipment -->
                <div class="equip-slot">
                    <span class="equip-label">Vedl. ruka</span>
                    <input type="text" class="equip-input" id="offhand">
                    <span class="equip-num">1</span>
                </div>
                <div class="equip-slot worn">
                    <span class="equip-label">Zbra≈à</span>
                    <input type="text" class="equip-input" id="weapon" placeholder="Kr√°tk√Ω meƒç HZ 5 PO≈† 3">
                    <span class="equip-num">2</span>
                </div>
            </div>

            <!-- Middle Column - Body -->
            <div class="body-col">
                <div class="body-slot">
                    <div class="body-header">
                        <span>Tƒõlo</span>
                        <span class="body-num">3</span>
                    </div>
                    <textarea class="body-input" id="body3"></textarea>
                </div>
                <div class="body-slot">
                    <div class="body-header">
                        <span>Tƒõlo</span>
                        <span class="body-num">4</span>
                    </div>
                    <textarea class="body-input" id="body4"></textarea>
                </div>
                <div class="body-slot">
                    <div class="body-header">
                        <span>Tƒõlo</span>
                        <span class="body-num">5</span>
                    </div>
                    <textarea class="body-input" id="body5"></textarea>
                </div>
                <div class="body-slot">
                    <div class="body-header">
                        <span>Tƒõlo</span>
                        <span class="body-num">6</span>
                    </div>
                    <textarea class="body-input" id="body6"></textarea>
                </div>
            </div>

            <!-- Right Column - Stashed -->
            <div class="stash-col">
                <div class="stash-slot">
                    <textarea class="stash-input" id="stash1" placeholder="J√≠dlo"></textarea>
                </div>
                <div class="stash-slot">
                    <textarea class="stash-input" id="stash2" placeholder="Lucerna"></textarea>
                </div>
                <div class="stash-slot" id="stashSlot3">
                    <textarea class="stash-input" id="stash3"></textarea>
                    <div class="unlock-label">Odemkne se p≈ôi S√çL 10</div>
                </div>
                <div class="stash-slot" id="stashSlot4">
                    <textarea class="stash-input" id="stash4"></textarea>
                    <div class="unlock-label">Odemkne se p≈ôi S√çL 12</div>
                </div>
            </div>
        </div>

        <div class="legend">
            <span>‚ñ™ Neseno: p≈ôipraveno k pou≈æit√≠</span>
            <span>‚ñ™ Obleƒçeno: rychle p≈ôipraviteln√©</span>
            <span>‚ñ™ Ulo≈æeno: akce k vybaven√≠</span>
        </div>

        <!-- Instruments -->
        <div class="instruments-section">
            <div class="inst-header">
                <span class="inst-title">N√°stroje</span>
                <span class="inst-note">P≈ôedmƒõty v tƒõchto slotech jsou obleƒçen√© a rychle p≈ôipraviteln√©</span>
            </div>
            <div class="inst-grid">
                <div class="inst-slot">
                    <div class="inst-slot-header">√örove≈à 1</div>
                    <textarea class="inst-input" id="inst1" placeholder="Povzbuzuj√≠c√≠ loutna"></textarea>
                </div>
                <div class="inst-slot locked" id="instSlot2">
                    <div class="inst-slot-header">Odemkne se na √∫rovni 3</div>
                    <textarea class="inst-input" id="inst2" disabled></textarea>
                </div>
                <div class="inst-slot locked" id="instSlot3">
                    <div class="inst-slot-header">Odemkne se na √∫rovni 5</div>
                    <textarea class="inst-input" id="inst3" disabled></textarea>
                </div>
            </div>
        </div>

        <!-- Jack of All Trades -->
        <div class="jack-section">
            <div class="jack-header">
                <span class="jack-title">V≈°eumƒõl</span>
                <span class="jack-used">pou≈æito dnes?</span>
            </div>
            <div class="jack-entries" id="jackEntries">
                <div class="jack-entry">
                    <input type="text" class="jack-input" placeholder="Talent / vyn√°lez / kouzlo...">
                    <input type="checkbox" class="jack-check">
                    <button class="remove-btn" onclick="removeJack(this)">√ó</button>
                </div>
            </div>
            <button class="add-btn" onclick="addJack()">+ P≈ôidat</button>
        </div>
    </div>

    <div class="saved-notice" id="savedNotice">‚úì Ulo≈æeno!</div>

    <script>
        // Reputation
        let currentRep = 0;
        document.querySelectorAll('.rep-circle').forEach(c => {
            c.addEventListener('click', () => {
                document.querySelectorAll('.rep-circle').forEach(x => x.classList.remove('active'));
                c.classList.add('active');
                currentRep = parseInt(c.dataset.rep);
            });
        });

        // Level checks - unlock instruments
        document.querySelectorAll('.level-check').forEach(check => {
            check.addEventListener('change', updateLocks);
        });

        function updateLocks() {
            let level = 1;
            for (let l = 2; l <= 5; l++) {
                const checks = document.querySelectorAll(`.level-check[data-level="${l-1}"]`);
                if (Array.from(checks).every(c => c.checked)) level = l;
            }

            const inst2 = document.getElementById('inst2');
            const inst3 = document.getElementById('inst3');
            const slot2 = document.getElementById('instSlot2');
            const slot3 = document.getElementById('instSlot3');

            if (level >= 3) {
                inst2.disabled = false;
                slot2.classList.remove('locked');
                slot2.querySelector('.inst-slot-header').textContent = '√örove≈à 3';
            } else {
                inst2.disabled = true;
                slot2.classList.add('locked');
                slot2.querySelector('.inst-slot-header').textContent = 'Odemkne se na √∫rovni 3';
            }

            if (level >= 5) {
                inst3.disabled = false;
                slot3.classList.remove('locked');
                slot3.querySelector('.inst-slot-header').textContent = '√örove≈à 5';
            } else {
                inst3.disabled = true;
                slot3.classList.add('locked');
                slot3.querySelector('.inst-slot-header').textContent = 'Odemkne se na √∫rovni 5';
            }
        }

        // Jack of All Trades
        function addJack() {
            const container = document.getElementById('jackEntries');
            const entry = document.createElement('div');
            entry.className = 'jack-entry';
            entry.innerHTML = `
                <input type="text" class="jack-input" placeholder="Talent / vyn√°lez / kouzlo...">
                <input type="checkbox" class="jack-check">
                <button class="remove-btn" onclick="removeJack(this)">√ó</button>
            `;
            container.appendChild(entry);
        }

        function removeJack(btn) {
            if (document.querySelectorAll('.jack-entry').length > 1) {
                btn.closest('.jack-entry').remove();
            }
        }

        // Save/Load
        function gatherData() {
            const data = {
                name: document.getElementById('charName').value,
                stats: {},
                hp: document.getElementById('hp').value,
                coins: document.getElementById('coins').value,
                reputation: currentRep,
                levelChecks: {},
                rings: [
                    document.getElementById('ring1').value,
                    document.getElementById('ring2').value
                ],
                offhand: document.getElementById('offhand').value,
                weapon: document.getElementById('weapon').value,
                body: [],
                stash: [],
                instruments: [],
                jack: []
            };

            ['str', 'dex', 'cha', 'int', 'luck'].forEach(s => {
                data.stats[s] = {
                    base: document.getElementById(s + 'Base').value,
                    curr: document.getElementById(s + 'Curr').value
                };
            });

            document.querySelectorAll('.level-check').forEach(c => {
                data.levelChecks[`${c.dataset.level}-${c.dataset.pos}`] = c.checked;
            });

            for (let i = 3; i <= 6; i++) {
                data.body.push(document.getElementById('body' + i).value);
            }

            for (let i = 1; i <= 4; i++) {
                data.stash.push(document.getElementById('stash' + i).value);
            }

            for (let i = 1; i <= 3; i++) {
                data.instruments.push(document.getElementById('inst' + i).value);
            }

            document.querySelectorAll('.jack-entry').forEach(e => {
                data.jack.push({
                    text: e.querySelector('.jack-input').value,
                    used: e.querySelector('.jack-check').checked
                });
            });

            return data;
        }

        function applyData(data) {
            document.getElementById('charName').value = data.name || '';
            document.getElementById('hp').value = data.hp || 9;
            document.getElementById('coins').value = data.coins || 0;

            if (data.stats) {
                ['str', 'dex', 'cha', 'int', 'luck'].forEach(s => {
                    if (data.stats[s]) {
                        document.getElementById(s + 'Base').value = data.stats[s].base || '';
                        document.getElementById(s + 'Curr').value = data.stats[s].curr || '';
                    }
                });
            }

            if (data.reputation !== undefined) {
                currentRep = data.reputation;
                document.querySelectorAll('.rep-circle').forEach(c => {
                    c.classList.remove('active');
                    if (parseInt(c.dataset.rep) === currentRep) c.classList.add('active');
                });
            }

            if (data.levelChecks) {
                Object.keys(data.levelChecks).forEach(key => {
                    const [lv, pos] = key.split('-');
                    const check = document.querySelector(`.level-check[data-level="${lv}"][data-pos="${pos}"]`);
                    if (check) check.checked = data.levelChecks[key];
                });
                updateLocks();
            }

            if (data.rings) {
                document.getElementById('ring1').value = data.rings[0] || '';
                document.getElementById('ring2').value = data.rings[1] || '';
            }

            document.getElementById('offhand').value = data.offhand || '';
            document.getElementById('weapon').value = data.weapon || '';

            if (data.body) {
                data.body.forEach((v, i) => {
                    const el = document.getElementById('body' + (i + 3));
                    if (el) el.value = v || '';
                });
            }

            if (data.stash) {
                data.stash.forEach((v, i) => {
                    const el = document.getElementById('stash' + (i + 1));
                    if (el) el.value = v || '';
                });
            }

            if (data.instruments) {
                data.instruments.forEach((v, i) => {
                    const el = document.getElementById('inst' + (i + 1));
                    if (el) el.value = v || '';
                });
            }

            if (data.jack && data.jack.length > 0) {
                const container = document.getElementById('jackEntries');
                container.innerHTML = '';
                data.jack.forEach(j => {
                    const entry = document.createElement('div');
                    entry.className = 'jack-entry';
                    entry.innerHTML = `
                        <input type="text" class="jack-input" value="${j.text || ''}" placeholder="Talent / vyn√°lez / kouzlo...">
                        <input type="checkbox" class="jack-check" ${j.used ? 'checked' : ''}>
                        <button class="remove-btn" onclick="removeJack(this)">√ó</button>
                    `;
                    container.appendChild(entry);
                });
            }
        }

        function saveToFile() {
            const data = gatherData();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            const name = data.name || 'bard';
            a.download = `${name.replace(/[^a-zA-Z0-9√°ƒçƒè√©ƒõ√≠≈à√≥≈ô≈°≈•√∫≈Ø√Ω≈æ√Åƒåƒé√âƒö√ç≈á√ì≈ò≈†≈§√ö≈Æ√ù≈Ω ]/g, '')}.json`;
            a.click();
            URL.revokeObjectURL(a.href);
            showNotice();
        }

        function loadFromFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = e => {
                try {
                    applyData(JSON.parse(e.target.result));
                    showNotice('Naƒçteno!');
                } catch (err) {
                    alert('Chyba p≈ôi naƒç√≠t√°n√≠');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function showNotice(text = '‚úì Ulo≈æeno!') {
            const n = document.getElementById('savedNotice');
            n.textContent = text;
            n.classList.add('show');
            setTimeout(() => n.classList.remove('show'), 2000);
        }
    </script>
</body>
</html>
